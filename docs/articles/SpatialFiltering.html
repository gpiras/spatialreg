<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Moran Eigenvectors • spatialreg</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Moran Eigenvectors">
<meta property="og:description" content="spatialreg">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">spatialreg</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.3-2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/SpatialFiltering.html">Moran Eigenvectors</a>
    </li>
    <li>
      <a href="../articles/nb_igraph.html">Spatial weights objects as sparse matrices and graphs</a>
    </li>
    <li>
      <a href="../articles/sids_models.html">North Carolina SIDS data set (models)</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/r-spatial/spatialreg/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Moran Eigenvectors</h1>
                        <h4 data-toc-skip class="author">Roger
Bivand</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/r-spatial/spatialreg/blob/HEAD/vignettes/SpatialFiltering.Rmd" class="external-link"><code>vignettes/SpatialFiltering.Rmd</code></a></small>
      <div class="hidden name"><code>SpatialFiltering.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="introduction-1">Introduction <a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a><a class="anchor" aria-label="anchor" href="#introduction-1"></a>
</h2>
<p>The Moran eigenvector approach <span class="citation">(<a href="#ref-dray+legendre+peres-neto:06">Dray, Legendre, and Peres-Neto
2006</a>; <a href="#ref-griffith+peres-neto:06">Griffith and Peres-Neto
2006</a>)</span> involved the spatial patterns represented by maps of
eigenvectors; by choosing suitable orthogonal patterns and adding them
to a linear or generalised linear model, the spatial dependence present
in the residuals can be moved into the model.</p>
<p>It uses brute force to search the set of eigenvectors of the matrix
<span class="math inline">\(\mathbf{M W M}\)</span>, where</p>
<p><span class="math display">\[\mathbf{M} = \mathbf{I} -
\mathbf{X}(\mathbf{X}^{\rm T}
\mathbf{X})^{-1}\mathbf{X}^{\rm T}\]</span> is a symmetric and
idempotent projection matrix and <span class="math inline">\(\mathbf{W}\)</span> are the spatial weights. In
the spatial lag form of <span><code>SpatialFiltering</code></span> and
in the GLM <span><code>ME</code></span> form below, <span class="math inline">\(\mathbf{X}\)</span> is an <span class="math inline">\(n\)</span>-vector of ones, that is the intercept
only.</p>
<p>In its general form, <span><code>SpatialFiltering</code></span>
chooses the subset of the <span class="math inline">\(n\)</span>
eigenvectors that reduce the residual spatial autocorrelation in the
error of the model with covariates. The lag form adds the covariates in
assessment of which eigenvectors to choose, but does not use them in
constructing the eigenvectors.
<span><code>SpatialFiltering</code></span> was implemented and
contributed by Yongwan Chun and Michael Tiefelsdorf, and is presented in
<span class="citation">Tiefelsdorf and Griffith (<a href="#ref-tiefelsdorf+griffith:07">2007</a>)</span>;
<span><code>ME</code></span> is based on Matlab code by Pedro Peres-Neto
and is discussed in <span class="citation">Dray, Legendre, and
Peres-Neto (<a href="#ref-dray+legendre+peres-neto:06">2006</a>)</span>
and <span class="citation">Griffith and Peres-Neto (<a href="#ref-griffith+peres-neto:06">2006</a>)</span>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/r-spatial/spdep/" class="external-link">spdep</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="st"><a href="https://r-spatial.github.io/sf/" class="external-link">"sf"</a></span>, quietly<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">NY8</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_read.html" class="external-link">st_read</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"shapes/NY8_utm18.shp"</span>, package<span class="op">=</span><span class="st">"spData"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Reading layer `NY8_utm18' from data source </span></span>
<span><span class="co">##   `/home/rsb/lib/r_libs/spData/shapes/NY8_utm18.shp' using driver `ESRI Shapefile'</span></span>
<span><span class="co">## Simple feature collection with 281 features and 17 fields</span></span>
<span><span class="co">## Geometry type: POLYGON</span></span>
<span><span class="co">## Dimension:     XY</span></span>
<span><span class="co">## Bounding box:  xmin: 358241.9 ymin: 4649755 xmax: 480393.1 ymax: 4808545</span></span>
<span><span class="co">## Projected CRS: WGS 84 / UTM zone 18N</span></span></code></pre>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">NY_nb</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/spdep/reference/read.gal.html" class="external-link">read.gal</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"weights/NY_nb.gal"</span>, package<span class="op">=</span><span class="st">"spData"</span><span class="op">)</span>, override.id<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/r-spatial/spatialreg/" class="external-link">spatialreg</a></span><span class="op">)</span></span>
<span><span class="va">nySFE</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/SpatialFiltering.html">SpatialFiltering</a></span><span class="op">(</span><span class="va">Z</span><span class="op">~</span><span class="va">PEXPOSURE</span><span class="op">+</span><span class="va">PCTAGE65P</span><span class="op">+</span><span class="va">PCTOWNHOME</span>, data<span class="op">=</span><span class="va">NY8</span>, nb<span class="op">=</span><span class="va">NY_nb</span>, style<span class="op">=</span><span class="st">"W"</span>, verbose<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">nylmSFE</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">Z</span><span class="op">~</span><span class="va">PEXPOSURE</span><span class="op">+</span><span class="va">PCTAGE65P</span><span class="op">+</span><span class="va">PCTOWNHOME</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/stats/fitted.values.html" class="external-link">fitted</a></span><span class="op">(</span><span class="va">nySFE</span><span class="op">)</span>, data<span class="op">=</span><span class="va">NY8</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">nylmSFE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Call:</span></span>
<span><span class="co">## lm(formula = Z ~ PEXPOSURE + PCTAGE65P + PCTOWNHOME + fitted(nySFE), </span></span>
<span><span class="co">##     data = NY8)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Residuals:</span></span>
<span><span class="co">##     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">## -1.5184 -0.3523 -0.0105  0.3221  3.1964 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Coefficients:</span></span>
<span><span class="co">##                    Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">## (Intercept)        -0.51728    0.14606  -3.542 0.000469 ***</span></span>
<span><span class="co">## PEXPOSURE           0.04884    0.03230   1.512 0.131717    </span></span>
<span><span class="co">## PCTAGE65P           3.95089    0.55776   7.083 1.25e-11 ***</span></span>
<span><span class="co">## PCTOWNHOME         -0.56004    0.15688  -3.570 0.000423 ***</span></span>
<span><span class="co">## fitted(nySFE)vec13 -2.09397    0.60534  -3.459 0.000630 ***</span></span>
<span><span class="co">## fitted(nySFE)vec44 -2.24003    0.60534  -3.700 0.000261 ***</span></span>
<span><span class="co">## fitted(nySFE)vec6   1.02979    0.60534   1.701 0.090072 .  </span></span>
<span><span class="co">## fitted(nySFE)vec38  1.29282    0.60534   2.136 0.033613 *  </span></span>
<span><span class="co">## fitted(nySFE)vec20  1.10064    0.60534   1.818 0.070150 .  </span></span>
<span><span class="co">## fitted(nySFE)vec14 -1.05105    0.60534  -1.736 0.083662 .  </span></span>
<span><span class="co">## fitted(nySFE)vec75  1.90600    0.60534   3.149 0.001826 ** </span></span>
<span><span class="co">## fitted(nySFE)vec21 -1.06331    0.60534  -1.757 0.080138 .  </span></span>
<span><span class="co">## fitted(nySFE)vec36  1.17861    0.60534   1.947 0.052578 .  </span></span>
<span><span class="co">## fitted(nySFE)vec61 -1.08582    0.60534  -1.794 0.073986 .  </span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Residual standard error: 0.6053 on 267 degrees of freedom</span></span>
<span><span class="co">## Multiple R-squared:  0.3401, Adjusted R-squared:  0.308 </span></span>
<span><span class="co">## F-statistic: 10.58 on 13 and 267 DF,  p-value: &lt; 2.2e-16</span></span></code></pre>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">nylm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">Z</span><span class="op">~</span><span class="va">PEXPOSURE</span><span class="op">+</span><span class="va">PCTAGE65P</span><span class="op">+</span><span class="va">PCTOWNHOME</span>, data<span class="op">=</span><span class="va">NY8</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">nylm</span>, <span class="va">nylmSFE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Analysis of Variance Table</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Model 1: Z ~ PEXPOSURE + PCTAGE65P + PCTOWNHOME</span></span>
<span><span class="co">## Model 2: Z ~ PEXPOSURE + PCTAGE65P + PCTOWNHOME + fitted(nySFE)</span></span>
<span><span class="co">##   Res.Df     RSS Df Sum of Sq      F    Pr(&gt;F)    </span></span>
<span><span class="co">## 1    277 119.619                                  </span></span>
<span><span class="co">## 2    267  97.837 10    21.782 5.9444 3.988e-08 ***</span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code></pre>
<p>Since the <span><code>SpatialFiltering</code></span> approach does
not allow weights to be used, we see that the residual autocorrelation
of the original linear model is absorbed, or ‘whitened’ by the inclusion
of selected eigenvectors in the model, but that the covariate
coefficients change little. The addition of these eigenvectors – each
representing an independent spatial pattern – relieves the residual
autocorrelation, but otherwise makes few changes in the substantive
coefficient values.</p>
<p>The <span><code>ME</code></span> function also searches for
eigenvectors from the spatial lag variant of the underlying model, but
in a GLM framework. The criterion is a permutation bootstrap test on
Moran’s <span class="math inline">\(I\)</span> for regression residuals,
and in this case, because of the very limited remaining spatial
autocorrelation, is set at <span class="math inline">\(\alpha =
0.5\)</span>. Even with this very generous stopping rule, only few
eigenvectors are chosen; their combined contribution only just improves
the fit of the GLM model.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">NYlistwW</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/spdep/reference/nb2listw.html" class="external-link">nb2listw</a></span><span class="op">(</span><span class="va">NY_nb</span>, style <span class="op">=</span> <span class="st">"W"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">111</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">nyME</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ME.html">ME</a></span><span class="op">(</span><span class="va">Cases</span><span class="op">~</span><span class="va">PEXPOSURE</span><span class="op">+</span><span class="va">PCTAGE65P</span><span class="op">+</span><span class="va">PCTOWNHOME</span>, data<span class="op">=</span><span class="va">NY8</span>, offset<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">POP8</span><span class="op">)</span>, family<span class="op">=</span><span class="st">"poisson"</span>, listw<span class="op">=</span><span class="va">NYlistwW</span>, alpha<span class="op">=</span><span class="fl">0.44</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">nyME</span></span></code></pre></div>
<pre><code><span><span class="co">##   Eigenvector ZI pr(ZI)</span></span>
<span><span class="co">## 0          NA NA   0.31</span></span>
<span><span class="co">## 1          24 NA   0.44</span></span>
<span><span class="co">## 2         223 NA   0.42</span></span>
<span><span class="co">## 3         206 NA   0.43</span></span>
<span><span class="co">## 4         169 NA   0.48</span></span></code></pre>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">NY8</span><span class="op">$</span><span class="va">eigen_24</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/fitted.values.html" class="external-link">fitted</a></span><span class="op">(</span><span class="va">nyME</span><span class="op">)</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span></span>
<span><span class="va">NY8</span><span class="op">$</span><span class="va">eigen_223</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/fitted.values.html" class="external-link">fitted</a></span><span class="op">(</span><span class="va">nyME</span><span class="op">)</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span></span></code></pre></div>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">nyglmME</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span><span class="va">Cases</span><span class="op">~</span><span class="va">PEXPOSURE</span><span class="op">+</span><span class="va">PCTAGE65P</span><span class="op">+</span><span class="va">PCTOWNHOME</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/stats/offset.html" class="external-link">offset</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">POP8</span><span class="op">)</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/stats/fitted.values.html" class="external-link">fitted</a></span><span class="op">(</span><span class="va">nyME</span><span class="op">)</span>, data<span class="op">=</span><span class="va">NY8</span>, family<span class="op">=</span><span class="st">"poisson"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">nyglmME</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Call:</span></span>
<span><span class="co">## glm(formula = Cases ~ PEXPOSURE + PCTAGE65P + PCTOWNHOME + offset(log(POP8)) + </span></span>
<span><span class="co">##     fitted(nyME), family = "poisson", data = NY8)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Coefficients:</span></span>
<span><span class="co">##                    Estimate Std. Error z value Pr(&gt;|z|)    </span></span>
<span><span class="co">## (Intercept)        -8.13431    0.18388 -44.237  &lt; 2e-16 ***</span></span>
<span><span class="co">## PEXPOSURE           0.14136    0.03134   4.511 6.45e-06 ***</span></span>
<span><span class="co">## PCTAGE65P           4.16875    0.60149   6.931 4.19e-12 ***</span></span>
<span><span class="co">## PCTOWNHOME         -0.39290    0.19222  -2.044  0.04096 *  </span></span>
<span><span class="co">## fitted(nyME)vec24   1.62658    0.72243   2.252  0.02435 *  </span></span>
<span><span class="co">## fitted(nyME)vec223  0.92941    0.70391   1.320  0.18671    </span></span>
<span><span class="co">## fitted(nyME)vec206 -0.11559    0.68987  -0.168  0.86693    </span></span>
<span><span class="co">## fitted(nyME)vec169 -1.82674    0.68142  -2.681  0.00735 ** </span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## (Dispersion parameter for poisson family taken to be 1)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     Null deviance: 428.25  on 280  degrees of freedom</span></span>
<span><span class="co">## Residual deviance: 340.08  on 273  degrees of freedom</span></span>
<span><span class="co">## AIC: Inf</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Number of Fisher Scoring iterations: 5</span></span></code></pre>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">nyGLMp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span><span class="va">Cases</span><span class="op">~</span><span class="va">PEXPOSURE</span><span class="op">+</span><span class="va">PCTAGE65P</span><span class="op">+</span><span class="va">PCTOWNHOME</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/stats/offset.html" class="external-link">offset</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">POP8</span><span class="op">)</span><span class="op">)</span>, data<span class="op">=</span><span class="va">NY8</span>,family<span class="op">=</span><span class="st">"poisson"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">nyGLMp</span>, <span class="va">nyglmME</span>, test<span class="op">=</span><span class="st">"Chisq"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Analysis of Deviance Table</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Model 1: Cases ~ PEXPOSURE + PCTAGE65P + PCTOWNHOME + offset(log(POP8))</span></span>
<span><span class="co">## Model 2: Cases ~ PEXPOSURE + PCTAGE65P + PCTOWNHOME + offset(log(POP8)) + </span></span>
<span><span class="co">##     fitted(nyME)</span></span>
<span><span class="co">##   Resid. Df Resid. Dev Df Deviance Pr(&gt;Chi)  </span></span>
<span><span class="co">## 1       277     353.35                       </span></span>
<span><span class="co">## 2       273     340.08  4   13.269  0.01003 *</span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code></pre>
<p>Figure <span class="math display">\[fig:geigen2\]</span> shows the
spatial patterns chosen to match the very small amount of spatial
autocorrelation remaining in the model. As with the other Poisson
regressions, the closeness to TCE sites is highly significant. Since,
however, many TCE sites are also in or close to more densely populated
urban areas with the possible presence of both point-source and
non-point-source pollution, it would be premature to take such results
simply at their face value. There is, however, a potentially useful
contrast between the cities of Binghamton in the south of the study area
with several sites in its vicinity, and Syracuse in the north without
TCE sites in this data set.</p>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-dray+legendre+peres-neto:06" class="csl-entry">
Dray, S., P. Legendre, and P. R. Peres-Neto. 2006. <span>“Spatial
Modeling: A Comprehensive Framework for Principle Coordinate Analysis of
Neighbor Matrices (<span>PCNM</span>).”</span> <em>Ecological
Modelling</em> 196: 483–93.
</div>
<div id="ref-griffith+peres-neto:06" class="csl-entry">
Griffith, D. A., and P. R. Peres-Neto. 2006. <span>“Spatial Modeling in
Ecology: The Flexibility of Eigenfunction Spatial Analyses.”</span>
<em>Ecology</em> 87: 2603–13.
</div>
<div id="ref-tiefelsdorf+griffith:07" class="csl-entry">
Tiefelsdorf, M., and D. A. Griffith. 2007. <span>“Semiparametric
Filtering of Spatial Autocorrelation: The Eigenvector Approach.”</span>
<em>Environment and Planning A</em> 39: 1193–1221.
</div>
</div>
</div>
<div class="footnotes footnotes-end-of-document">
<hr>
<ol>
<li id="fn1"><p>This vignette formed pp. 302–305 of the first edition of
Bivand, R. S., Pebesma, E. and Gómez-Rubio V. (2008) Applied Spatial
Data Analysis with R, Springer-Verlag, New York. It was retired from the
second edition (2013) to accommodate material on other topics, and is
made available in this form with the understanding of the publishers.<a href="#fnref1" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Roger Bivand, Gianfranco Piras.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
