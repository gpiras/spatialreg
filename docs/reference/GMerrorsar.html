<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Spatial simultaneous autoregressive error model estimation by GMM — GMerrorsar • spatialreg</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Spatial simultaneous autoregressive error model estimation by GMM — GMerrorsar" />
<meta property="og:description" content="An implementation of Kelejian and Prucha's generalised moments estimator for the autoregressive parameter in a spatial model." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">spatialreg</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.1-7</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/SpatialFiltering.html">Moran Eigenvectors</a>
    </li>
    <li>
      <a href="../articles/sids_models.html">North Carolina SIDS data set (models)</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/r-spatial/spatialreg/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Spatial simultaneous autoregressive error model estimation by GMM</h1>
    
    <div class="hidden name"><code>GMerrorsar.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>An implementation of Kelejian and Prucha's generalised moments estimator for the autoregressive parameter in a spatial model.</p>
    </div>

    <pre class="usage"><span class='fu'>GMerrorsar</span><span class='op'>(</span><span class='va'>formula</span>, data <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='op'>)</span>, <span class='va'>listw</span>, na.action <span class='op'>=</span> <span class='va'>na.fail</span>,
 zero.policy <span class='op'>=</span> <span class='cn'>NULL</span>, method<span class='op'>=</span><span class='st'>"nlminb"</span>, arnoldWied<span class='op'>=</span><span class='cn'>FALSE</span>, 
 control <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='op'>)</span>, <span class='va'>pars</span>, scaleU<span class='op'>=</span><span class='cn'>FALSE</span>, verbose<span class='op'>=</span><span class='cn'>NULL</span>, legacy<span class='op'>=</span><span class='cn'>FALSE</span>,
 se.lambda<span class='op'>=</span><span class='cn'>TRUE</span>, returnHcov<span class='op'>=</span><span class='cn'>FALSE</span>, pWOrder<span class='op'>=</span><span class='fl'>250</span>, tol.Hcov<span class='op'>=</span><span class='fl'>1.0e-10</span><span class='op'>)</span>
<span class='co'># S3 method for Gmsar</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>object</span>, correlation <span class='op'>=</span> <span class='cn'>FALSE</span>, Hausman<span class='op'>=</span><span class='cn'>FALSE</span>, <span class='va'>...</span><span class='op'>)</span>
<span class='fu'>GMargminImage</span><span class='op'>(</span><span class='va'>obj</span>, <span class='va'>lambdaseq</span>, <span class='va'>s2seq</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>formula</th>
      <td><p>a symbolic description of the model to be fit. The details 
of model specification are given for <code><a href='https://rdrr.io/r/stats/lm.html'>lm()</a></code></p></td>
    </tr>
    <tr>
      <th>data</th>
      <td><p>an optional data frame containing the variables in the model. 
By default the variables are taken from the environment which the function 
is called.</p></td>
    </tr>
    <tr>
      <th>listw</th>
      <td><p>a <code>listw</code> object created for example by <code>nb2listw</code></p></td>
    </tr>
    <tr>
      <th>na.action</th>
      <td><p>a function (default <code>na.fail</code>), can also be <code>na.omit</code> or <code>na.exclude</code> with consequences for residuals and fitted values - in these cases the weights list will be subsetted to remove NAs in the data. It may be necessary to set zero.policy to TRUE because this subsetting may create no-neighbour observations. Note that only weights lists created without using the glist argument to <code>nb2listw</code> may be subsetted.</p></td>
    </tr>
    <tr>
      <th>zero.policy</th>
      <td><p>default NULL, use global option value; if TRUE assign zero to the lagged value of zones without 
neighbours, if FALSE (default) assign NA - causing <code>GMerrorsar()</code> to terminate with an error</p></td>
    </tr>
    <tr>
      <th>method</th>
      <td><p>default <code>"nlminb"</code>, or optionally a method passed to <code>optim</code> to use an alternative optimizer</p></td>
    </tr>
    <tr>
      <th>arnoldWied</th>
      <td><p>default FALSE</p></td>
    </tr>
    <tr>
      <th>control</th>
      <td><p>A list of control parameters. See details in <code><a href='https://rdrr.io/r/stats/optim.html'>optim</a></code> or <code><a href='https://rdrr.io/r/stats/nlminb.html'>nlminb</a></code>.</p></td>
    </tr>
    <tr>
      <th>pars</th>
      <td><p>starting values for \(\lambda\) and \(\sigma^2\) for GMM optimisation, if missing (default), approximated from initial OLS model as the autocorrelation coefficient corrected for weights style and model sigma squared</p></td>
    </tr>
    <tr>
      <th>scaleU</th>
      <td><p>Default FALSE: scale the OLS residuals before computing the moment matrices; only used if the <code>pars</code> argument is missing</p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p>default NULL, use global option value; if TRUE, reports function values during optimization.</p></td>
    </tr>
    <tr>
      <th>legacy</th>
      <td><p>default FALSE - compute using the unfiltered values of the response and right hand side variables; if TRUE - compute the fitted value and residuals from the spatially filtered model using the spatial error parameter</p></td>
    </tr>
    <tr>
      <th>se.lambda</th>
      <td><p>default TRUE, use the analytical method described in <a href='http://econweb.umd.edu/~prucha/STATPROG/OLS/desols.pdf'>http://econweb.umd.edu/~prucha/STATPROG/OLS/desols.pdf</a></p></td>
    </tr>
    <tr>
      <th>returnHcov</th>
      <td><p>default FALSE, return the Vo matrix for a spatial Hausman test</p></td>
    </tr>
    <tr>
      <th>tol.Hcov</th>
      <td><p>the tolerance for computing the Vo matrix (default=1.0e-10)</p></td>
    </tr>
    <tr>
      <th>pWOrder</th>
      <td><p>default 250, if returnHcov=TRUE, pass this order to <code>powerWeights</code> as the power series maximum limit</p></td>
    </tr>
    <tr>
      <th>object, obj</th>
      <td><p><code>Gmsar</code> object from <code>GMerrorsar</code></p></td>
    </tr>
    <tr>
      <th>correlation</th>
      <td><p>logical; (default=FALSE), TRUE not available</p></td>
    </tr>
    <tr>
      <th>Hausman</th>
      <td><p>if TRUE, the results of the Hausman test for error models are reported</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p><code>summary</code> arguments passed through</p></td>
    </tr>
    <tr>
      <th>lambdaseq</th>
      <td><p>if given, an increasing sequence of lambda values for gridding</p></td>
    </tr>
    <tr>
      <th>s2seq</th>
      <td><p>if given, an increasing sequence of sigma squared values for gridding</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>When the control list is set with care, the function will converge to values close to the ML estimator without requiring computation of the Jacobian, the most resource-intensive part of ML estimation.</p>
<p>Note that the fitted() function for the output object assumes that the response 
variable may be reconstructed as the sum of the trend, the signal, and the
noise (residuals). Since the values of the response variable are known,
their spatial lags are used to calculate signal components (Cressie 1993, p. 564). This differs from other software, including GeoDa, which does not use knowledge of the response 
variable in making predictions for the fitting data.</p>
<p>The <code>GMargminImage</code> may be used to visualize the shape of the surface of the argmin function used to find lambda.</p>
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A list object of class <code>Gmsar</code></p>
<dt>type</dt><dd><p>"ERROR"</p></dd>
  <dt>lambda</dt><dd><p>simultaneous autoregressive error coefficient</p></dd>
  <dt>coefficients</dt><dd><p>GMM coefficient estimates</p></dd>
  <dt>rest.se</dt><dd><p>GMM coefficient standard errors</p></dd>
  <dt>s2</dt><dd><p>GMM residual variance</p></dd>
  <dt>SSE</dt><dd><p>sum of squared GMM errors</p></dd>
  <dt>parameters</dt><dd><p>number of parameters estimated</p></dd>
  <dt>lm.model</dt><dd><p>the <code>lm</code> object returned when estimating for \(\lambda=0\)</p></dd>
  <dt>call</dt><dd><p>the call used to create this object</p></dd>
  <dt>residuals</dt><dd><p>GMM residuals</p></dd>
  <dt>lm.target</dt><dd><p>the <code>lm</code> object returned for the GMM fit</p></dd>
  <dt>fitted.values</dt><dd><p>Difference between residuals and response variable</p></dd>
  <dt>formula</dt><dd><p>model formula</p></dd>
  <dt>aliased</dt><dd><p>if not NULL, details of aliased variables</p></dd>
  <dt>zero.policy</dt><dd><p>zero.policy for this model</p></dd>
  <dt>vv</dt><dd><p>list of internal bigG and litg components for testing optimisation surface</p></dd>
  <dt>optres</dt><dd><p>object returned by optimizer</p></dd>
  <dt>pars</dt><dd><p>start parameter values for optimisation</p></dd>
  <dt>Hcov</dt><dd><p>Spatial DGP covariance matrix for Hausman test if available</p></dd>
  <dt>legacy</dt><dd><p>input choice of unfiltered or filtered values</p></dd>
  <dt>lambda.se</dt><dd><p>value computed if input argument TRUE</p></dd>
  <dt>arnoldWied</dt><dd><p>were Arnold-Wied moments used</p></dd>
  <dt>GMs2</dt><dd><p>GM argmin sigma squared</p></dd>
  <dt>scaleU</dt><dd><p>input choice of scaled OLS residuals</p></dd>
  <dt>vcov</dt><dd><p>variance-covariance matrix of regression coefficients</p></dd>
  <dt>na.action</dt><dd><p>(possibly) named vector of excluded or omitted observations if non-default na.action argument used</p></dd>

    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Kelejian, H. H., and Prucha, I. R., 1999. A Generalized Moments Estimator for the Autoregressive Parameter in a Spatial Model. International Economic Review, 40, pp. 509--533; Cressie, N. A. C. 1993 <em>Statistics for spatial data</em>, Wiley, New York.</p>
<p>Roger Bivand, Gianfranco Piras (2015). Comparing Implementations of Estimation Methods for Spatial Econometrics. <em>Journal of Statistical Software</em>, 63(18), 1-36. <a href='https://www.jstatsoft.org/v63/i18/'>https://www.jstatsoft.org/v63/i18/</a>.</p>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Luc Anselin and Roger Bivand</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='https://rdrr.io/r/stats/optim.html'>optim</a></code>, <code><a href='https://rdrr.io/r/stats/nlminb.html'>nlminb</a></code>, <code><a href='ML_models.html'>errorsarlm</a></code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'>#require("spdep", quietly=TRUE)</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>oldcol</span>, package<span class='op'>=</span><span class='st'>"spdep"</span><span class='op'>)</span>
<span class='va'>COL.errW.eig</span> <span class='op'>&lt;-</span> <span class='fu'><a href='ML_models.html'>errorsarlm</a></span><span class='op'>(</span><span class='va'>CRIME</span> <span class='op'>~</span> <span class='va'>INC</span> <span class='op'>+</span> <span class='va'>HOVAL</span>, data<span class='op'>=</span><span class='va'>COL.OLD</span>,
 <span class='fu'>spdep</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/spdep/man/nb2listw.html'>nb2listw</a></span><span class='op'>(</span><span class='va'>COL.nb</span>, style<span class='op'>=</span><span class='st'>"W"</span><span class='op'>)</span>, method<span class='op'>=</span><span class='st'>"eigen"</span><span class='op'>)</span>
<span class='op'>(</span><span class='va'>x</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>COL.errW.eig</span>, Hausman<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt; 
#&gt; Call:
#&gt; errorsarlm(formula = CRIME ~ INC + HOVAL, data = COL.OLD, listw = spdep::nb2listw(COL.nb, 
#&gt;     style = "W"), method = "eigen")
#&gt; 
#&gt; Residuals:
#&gt;       Min        1Q    Median        3Q       Max 
#&gt; -34.81174  -6.44031  -0.72142   7.61476  23.33626 
#&gt; 
#&gt; Type: error 
#&gt; Coefficients: (asymptotic standard errors) 
#&gt;              Estimate Std. Error z value  Pr(&gt;|z|)
#&gt; (Intercept) 59.893219   5.366163 11.1613 &lt; 2.2e-16
#&gt; INC         -0.941312   0.330569 -2.8476 0.0044057
#&gt; HOVAL       -0.302250   0.090476 -3.3407 0.0008358
#&gt; 
#&gt; Lambda: 0.56179, LR test value: 7.9935, p-value: 0.0046945
#&gt; Asymptotic standard error: 0.13387
#&gt;     z-value: 4.1966, p-value: 2.7098e-05
#&gt; Wald statistic: 17.611, p-value: 2.7098e-05
#&gt; 
#&gt; Log likelihood: -183.3805 for error model
#&gt; ML residual variance (sigma squared): 95.575, (sigma: 9.7762)
#&gt; Number of observations: 49 
#&gt; Number of parameters estimated: 5 
#&gt; AIC: 376.76, (AIC for lm: 382.75)
#&gt; Hausman test: 4.902, df: 3, p-value: 0.17911
#&gt; </div><div class='input'><span class='fu'><a href='https://rdrr.io/r/stats/coef.html'>coef</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span>
</div><div class='output co'>#&gt;               Estimate Std. Error   z value     Pr(&gt;|z|)
#&gt; (Intercept) 59.8932192 5.36616252 11.161276 0.0000000000
#&gt; INC         -0.9413120 0.33056857 -2.847554 0.0044056569
#&gt; HOVAL       -0.3022502 0.09047605 -3.340665 0.0008357788</div><div class='input'><span class='va'>COL.errW.GM</span> <span class='op'>&lt;-</span> <span class='fu'>GMerrorsar</span><span class='op'>(</span><span class='va'>CRIME</span> <span class='op'>~</span> <span class='va'>INC</span> <span class='op'>+</span> <span class='va'>HOVAL</span>, data<span class='op'>=</span><span class='va'>COL.OLD</span>,
 <span class='fu'>spdep</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/spdep/man/nb2listw.html'>nb2listw</a></span><span class='op'>(</span><span class='va'>COL.nb</span>, style<span class='op'>=</span><span class='st'>"W"</span><span class='op'>)</span>, returnHcov<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
<span class='op'>(</span><span class='va'>x</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>COL.errW.GM</span>, Hausman<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt; 
#&gt; Call:
#&gt; GMerrorsar(formula = CRIME ~ INC + HOVAL, data = COL.OLD, listw = spdep::nb2listw(COL.nb, 
#&gt;     style = "W"), returnHcov = TRUE)
#&gt; 
#&gt; Residuals:
#&gt;      Min       1Q   Median       3Q      Max 
#&gt; -30.5432  -6.5553  -2.1921  10.0553  28.7497 
#&gt; 
#&gt; Type: GM SAR estimator
#&gt; Coefficients: (GM standard errors) 
#&gt;              Estimate Std. Error z value  Pr(&gt;|z|)
#&gt; (Intercept) 62.513752   5.121339  12.207 &lt; 2.2e-16
#&gt; INC         -1.128283   0.339745  -3.321  0.000897
#&gt; HOVAL       -0.296957   0.095699  -3.103  0.001915
#&gt; 
#&gt; Lambda: 0.40196 (standard error): 0.42334 (z-value): 0.94948
#&gt; Residual variance (sigma squared): 106.64, (sigma: 10.327)
#&gt; GM argmin sigma squared: 106.36
#&gt; Number of observations: 49 
#&gt; Number of parameters estimated: 5 
#&gt; Hausman test: 6.6406, df: 3, p-value: 0.08428
#&gt; </div><div class='input'><span class='fu'><a href='https://rdrr.io/r/stats/coef.html'>coef</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span>
</div><div class='output co'>#&gt;               Estimate Std. Error   z value     Pr(&gt;|z|)
#&gt; (Intercept) 62.5137525 5.12133863 12.206526 0.0000000000
#&gt; INC         -1.1282834 0.33974492 -3.320972 0.0008970455
#&gt; HOVAL       -0.2969573 0.09569889 -3.103038 0.0019154486</div><div class='input'><span class='va'>aa</span> <span class='op'>&lt;-</span> <span class='fu'>GMargminImage</span><span class='op'>(</span><span class='va'>COL.errW.GM</span><span class='op'>)</span>
<span class='va'>levs</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/quantile.html'>quantile</a></span><span class='op'>(</span><span class='va'>aa</span><span class='op'>$</span><span class='va'>z</span>, <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>1</span>, <span class='fl'>1</span><span class='op'>/</span><span class='fl'>12</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/image.html'>image</a></span><span class='op'>(</span><span class='va'>aa</span>, breaks<span class='op'>=</span><span class='va'>levs</span>, xlab<span class='op'>=</span><span class='st'>"lambda"</span>, ylab<span class='op'>=</span><span class='st'>"s2"</span><span class='op'>)</span>
</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/points.html'>points</a></span><span class='op'>(</span><span class='va'>COL.errW.GM</span><span class='op'>$</span><span class='va'>lambda</span>, <span class='va'>COL.errW.GM</span><span class='op'>$</span><span class='va'>s2</span>, pch<span class='op'>=</span><span class='fl'>3</span>, lwd<span class='op'>=</span><span class='fl'>2</span><span class='op'>)</span>
</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/contour.html'>contour</a></span><span class='op'>(</span><span class='va'>aa</span>, levels<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/Round.html'>signif</a></span><span class='op'>(</span><span class='va'>levs</span>, <span class='fl'>4</span><span class='op'>)</span>, add<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
</div><div class='img'><img src='GMerrorsar-1.png' alt='' width='700' height='433' /></div><div class='input'><span class='va'>COL.errW.GM1</span> <span class='op'>&lt;-</span> <span class='fu'>GMerrorsar</span><span class='op'>(</span><span class='va'>CRIME</span> <span class='op'>~</span> <span class='va'>INC</span> <span class='op'>+</span> <span class='va'>HOVAL</span>, data<span class='op'>=</span><span class='va'>COL.OLD</span>,
 <span class='fu'>spdep</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/spdep/man/nb2listw.html'>nb2listw</a></span><span class='op'>(</span><span class='va'>COL.nb</span>, style<span class='op'>=</span><span class='st'>"W"</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>COL.errW.GM1</span><span class='op'>)</span>
</div><div class='output co'>#&gt; 
#&gt; Call:
#&gt; GMerrorsar(formula = CRIME ~ INC + HOVAL, data = COL.OLD, listw = spdep::nb2listw(COL.nb, 
#&gt;     style = "W"))
#&gt; 
#&gt; Residuals:
#&gt;      Min       1Q   Median       3Q      Max 
#&gt; -30.5432  -6.5553  -2.1921  10.0553  28.7497 
#&gt; 
#&gt; Type: GM SAR estimator
#&gt; Coefficients: (GM standard errors) 
#&gt;              Estimate Std. Error z value  Pr(&gt;|z|)
#&gt; (Intercept) 62.513752   5.121339  12.207 &lt; 2.2e-16
#&gt; INC         -1.128283   0.339745  -3.321  0.000897
#&gt; HOVAL       -0.296957   0.095699  -3.103  0.001915
#&gt; 
#&gt; Lambda: 0.40196 (standard error): 0.42334 (z-value): 0.94948
#&gt; Residual variance (sigma squared): 106.64, (sigma: 10.327)
#&gt; GM argmin sigma squared: 106.36
#&gt; Number of observations: 49 
#&gt; Number of parameters estimated: 5 
#&gt; </div><div class='input'><span class='kw'><a href='https://rdrr.io/r/base/library.html'>require</a></span><span class='op'>(</span><span class='st'><a href='https://r-spatial.github.io/sf/'>"sf"</a></span>, quietly<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='message'>Linking to GEOS 3.9.1, GDAL 3.2.2, PROJ 8.0.0</span></div><div class='input'><span class='va'>nydata</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://r-spatial.github.io/sf/reference/st_read.html'>st_read</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/system.file.html'>system.file</a></span><span class='op'>(</span><span class='st'>"shapes/NY8_bna_utm18.gpkg"</span>, package<span class='op'>=</span><span class='st'>"spData"</span><span class='op'>)</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span>, quiet<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/message.html'>suppressMessages</a></span><span class='op'>(</span><span class='va'>nyadjmat</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>as.matrix</a></span><span class='op'>(</span><span class='fu'>foreign</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/foreign/man/read.dbf.html'>read.dbf</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/system.file.html'>system.file</a></span><span class='op'>(</span>
 <span class='st'>"misc/nyadjwts.dbf"</span>, package<span class='op'>=</span><span class='st'>"spData"</span><span class='op'>)</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>)</span><span class='op'>[</span><span class='op'>-</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/message.html'>suppressMessages</a></span><span class='op'>(</span><span class='va'>ID</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/character.html'>as.character</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='fu'>foreign</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/foreign/man/read.dbf.html'>read.dbf</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/system.file.html'>system.file</a></span><span class='op'>(</span>
 <span class='st'>"misc/nyadjwts.dbf"</span>, package<span class='op'>=</span><span class='st'>"spData"</span><span class='op'>)</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>)</span><span class='op'>)</span><span class='op'>[</span><span class='op'>-</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/identical.html'>identical</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/substr.html'>substring</a></span><span class='op'>(</span><span class='va'>ID</span>, <span class='fl'>2</span>, <span class='fl'>10</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/substr.html'>substring</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/character.html'>as.character</a></span><span class='op'>(</span><span class='va'>nydata</span><span class='op'>$</span><span class='va'>AREAKEY</span><span class='op'>)</span>, <span class='fl'>2</span>, <span class='fl'>10</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] TRUE</div><div class='input'><span class='va'>nyadjlw</span> <span class='op'>&lt;-</span> <span class='fu'>spdep</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/spdep/man/mat2listw.html'>mat2listw</a></span><span class='op'>(</span><span class='va'>nyadjmat</span>, <span class='fu'><a href='https://rdrr.io/r/base/character.html'>as.character</a></span><span class='op'>(</span><span class='va'>nydata</span><span class='op'>$</span><span class='va'>AREAKEY</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>listw_NY</span> <span class='op'>&lt;-</span> <span class='fu'>spdep</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/spdep/man/nb2listw.html'>nb2listw</a></span><span class='op'>(</span><span class='va'>nyadjlw</span><span class='op'>$</span><span class='va'>neighbours</span>, style<span class='op'>=</span><span class='st'>"B"</span><span class='op'>)</span>
<span class='va'>esar1f</span> <span class='op'>&lt;-</span> <span class='fu'><a href='spautolm.html'>spautolm</a></span><span class='op'>(</span><span class='va'>Z</span> <span class='op'>~</span> <span class='va'>PEXPOSURE</span> <span class='op'>+</span> <span class='va'>PCTAGE65P</span> <span class='op'>+</span> <span class='va'>PCTOWNHOME</span>, data<span class='op'>=</span><span class='va'>nydata</span>,
 listw<span class='op'>=</span><span class='va'>listw_NY</span>, family<span class='op'>=</span><span class='st'>"SAR"</span>, method<span class='op'>=</span><span class='st'>"eigen"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>esar1f</span><span class='op'>)</span>
</div><div class='output co'>#&gt; 
#&gt; Call: 
#&gt; spautolm(formula = Z ~ PEXPOSURE + PCTAGE65P + PCTOWNHOME, data = nydata, 
#&gt;     listw = listw_NY, family = "SAR", method = "eigen")
#&gt; 
#&gt; Residuals:
#&gt;      Min       1Q   Median       3Q      Max 
#&gt; -1.56754 -0.38239 -0.02643  0.33109  4.01219 
#&gt; 
#&gt; Coefficients: 
#&gt;              Estimate Std. Error z value  Pr(&gt;|z|)
#&gt; (Intercept) -0.618193   0.176784 -3.4969 0.0004707
#&gt; PEXPOSURE    0.071014   0.042051  1.6888 0.0912635
#&gt; PCTAGE65P    3.754200   0.624722  6.0094 1.862e-09
#&gt; PCTOWNHOME  -0.419890   0.191329 -2.1946 0.0281930
#&gt; 
#&gt; Lambda: 0.040487 LR test value: 5.2438 p-value: 0.022026 
#&gt; Numerical Hessian standard error of lambda: 0.017209 
#&gt; 
#&gt; Log likelihood: -276.1069 
#&gt; ML residual variance (sigma squared): 0.41388, (sigma: 0.64333)
#&gt; Number of observations: 281 
#&gt; Number of parameters estimated: 6 
#&gt; AIC: 564.21
#&gt; </div><div class='input'><span class='va'>esar1gm</span> <span class='op'>&lt;-</span> <span class='fu'>GMerrorsar</span><span class='op'>(</span><span class='va'>Z</span> <span class='op'>~</span> <span class='va'>PEXPOSURE</span> <span class='op'>+</span> <span class='va'>PCTAGE65P</span> <span class='op'>+</span> <span class='va'>PCTOWNHOME</span>,
 data<span class='op'>=</span><span class='va'>nydata</span>, listw<span class='op'>=</span><span class='va'>listw_NY</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>esar1gm</span><span class='op'>)</span>
</div><div class='output co'>#&gt; 
#&gt; Call:GMerrorsar(formula = Z ~ PEXPOSURE + PCTAGE65P + PCTOWNHOME, 
#&gt;     data = nydata, listw = listw_NY)
#&gt; 
#&gt; Residuals:
#&gt;       Min        1Q    Median        3Q       Max 
#&gt; -1.641411 -0.396370 -0.026618  0.341740  4.204264 
#&gt; 
#&gt; Type: GM SAR estimator
#&gt; Coefficients: (GM standard errors) 
#&gt;              Estimate Std. Error z value  Pr(&gt;|z|)
#&gt; (Intercept) -0.604364   0.174576 -3.4619 0.0005364
#&gt; PEXPOSURE    0.067902   0.041164  1.6496 0.0990337
#&gt; PCTAGE65P    3.775308   0.622965  6.0602 1.359e-09
#&gt; PCTOWNHOME  -0.437545   0.188906 -2.3162 0.0205468
#&gt; 
#&gt; Lambda: 0.03605 (standard error): 0.2022 (z-value): 0.17829
#&gt; Residual variance (sigma squared): 0.41585, (sigma: 0.64487)
#&gt; GM argmin sigma squared: 0.45141
#&gt; Number of observations: 281 
#&gt; Number of parameters estimated: 6 
#&gt; </div><div class='input'><span class='va'>esar1gm1</span> <span class='op'>&lt;-</span> <span class='fu'>GMerrorsar</span><span class='op'>(</span><span class='va'>Z</span> <span class='op'>~</span> <span class='va'>PEXPOSURE</span> <span class='op'>+</span> <span class='va'>PCTAGE65P</span> <span class='op'>+</span> <span class='va'>PCTOWNHOME</span>,
 data<span class='op'>=</span><span class='va'>nydata</span>, listw<span class='op'>=</span><span class='va'>listw_NY</span>, method<span class='op'>=</span><span class='st'>"Nelder-Mead"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>esar1gm1</span><span class='op'>)</span>
</div><div class='output co'>#&gt; 
#&gt; Call:GMerrorsar(formula = Z ~ PEXPOSURE + PCTAGE65P + PCTOWNHOME, 
#&gt;     data = nydata, listw = listw_NY, method = "Nelder-Mead")
#&gt; 
#&gt; Residuals:
#&gt;       Min        1Q    Median        3Q       Max 
#&gt; -1.641390 -0.396374 -0.026616  0.341745  4.204277 
#&gt; 
#&gt; Type: GM SAR estimator
#&gt; Coefficients: (GM standard errors) 
#&gt;              Estimate Std. Error z value  Pr(&gt;|z|)
#&gt; (Intercept) -0.604384   0.174580 -3.4619 0.0005363
#&gt; PEXPOSURE    0.067907   0.041165  1.6496 0.0990225
#&gt; PCTAGE65P    3.775275   0.622969  6.0601  1.36e-09
#&gt; PCTOWNHOME  -0.437518   0.188910 -2.3160 0.0205572
#&gt; 
#&gt; Lambda: 0.036057 (standard error): 0.20221 (z-value): 0.17832
#&gt; Residual variance (sigma squared): 0.41585, (sigma: 0.64487)
#&gt; GM argmin sigma squared: 0.45139
#&gt; Number of observations: 281 
#&gt; Number of parameters estimated: 6 
#&gt; </div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Roger Bivand, Gianfranco Piras.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


