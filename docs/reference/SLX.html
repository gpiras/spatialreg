<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Spatial Durbin linear (SLX, spatially lagged X) model — lmSLX • spatialreg</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Spatial Durbin linear (SLX, spatially lagged X) model — lmSLX"><meta property="og:description" content="lmSLX fits an lm model augmented with the spatially lagged RHS variables, including the lagged intercept when the spatial weights are not row-standardised. create_WX creates spatially lagged RHS variables, and is exposed for use in model fitting functions."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">spatialreg</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.2-5</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/SpatialFiltering.html">Moran Eigenvectors</a>
    </li>
    <li>
      <a href="../articles/nb_igraph.html">Spatial weights objects as sparse matrices and graphs</a>
    </li>
    <li>
      <a href="../articles/sids_models.html">North Carolina SIDS data set (models)</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/r-spatial/spatialreg/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Spatial Durbin linear (SLX, spatially lagged X) model</h1>
    
    <div class="hidden name"><code>SLX.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>lmSLX</code> fits an <code>lm</code> model augmented with the spatially lagged RHS variables, including the lagged intercept when the spatial weights are not row-standardised. <code>create_WX</code> creates spatially lagged RHS variables, and is exposed for use in model fitting functions.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">lmSLX</span><span class="op">(</span><span class="va">formula</span>, data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>, <span class="va">listw</span>, <span class="va">na.action</span>, weights<span class="op">=</span><span class="cn">NULL</span>,</span>
<span> Durbin<span class="op">=</span><span class="cn">TRUE</span>, zero.policy<span class="op">=</span><span class="cn">NULL</span><span class="op">)</span></span>
<span><span class="fu">create_WX</span><span class="op">(</span><span class="va">x</span>, <span class="va">listw</span>, zero.policy<span class="op">=</span><span class="cn">NULL</span>, prefix<span class="op">=</span><span class="st">""</span><span class="op">)</span></span>
<span><span class="co"># S3 method for SlX</span></span>
<span><span class="fu"><a href="impacts.html">impacts</a></span><span class="op">(</span><span class="va">obj</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="co"># S3 method for WXimpact</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="co"># S3 method for WXimpact</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">object</span>, <span class="va">...</span>, adjust_k<span class="op">=</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">object</span>, <span class="st">"type"</span><span class="op">)</span> <span class="op">==</span> <span class="st">"SDEM"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># S3 method for SlX</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">object</span>, <span class="va">newdata</span>, <span class="va">listw</span>, zero.policy<span class="op">=</span><span class="cn">NULL</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>formula</dt>
<dd><p>a symbolic description of the model to be fit. The details 
of model specification are given for <code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm()</a></code></p></dd>

  <dt>data</dt>
<dd><p>an optional data frame containing the variables in the model. 
By default the variables are taken from the environment which the function 
is called.</p></dd>

  <dt>listw</dt>
<dd><p>a <code>listw</code> object created for example by <code>nb2listw</code></p></dd>

  <dt>na.action</dt>
<dd><p>a function (default <code>options("na.action")</code>), can also be <code>na.omit</code> or <code>na.exclude</code> with consequences for residuals and fitted values - in these cases the spatial weights list will be subsetted to remove NAs in the data. It may be necessary to set zero.policy to TRUE because this subsetting may create no-neighbour observations. Note that only weights lists created without using the glist argument to <code>nb2listw</code> may be subsetted.</p></dd>

  <dt>weights</dt>
<dd><p>an optional vector of weights to be used in the fitting process. Non-NULL weights can be used to indicate that different observations have different variances (with the values in weights being inversely proportional to the variances); or equivalently, when the elements of weights are positive integers w_i, that each response y_i is the mean of w_i unit-weight observations (including the case that there are w_i observations equal to y_i and the data have been summarized) - <code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></code></p></dd>

  <dt>Durbin</dt>
<dd><p>default TRUE for <code>lmSLX</code> (Durbin model including WX); if TRUE, full spatial Durbin model; if a formula object, the subset of explanatory variables to lag</p></dd>

  <dt>zero.policy</dt>
<dd><p>default NULL, use global option value; if TRUE assign zero to the lagged value of zones without 
neighbours, if FALSE assign NA</p></dd>

  <dt>obj</dt>
<dd><p>A spatial regression object created by <code>lmSLX</code></p></dd>

  <dt>...</dt>
<dd><p>Arguments passed through</p></dd>

  <dt>prefix</dt>
<dd><p>default empty string, may be “lag” in some cases</p></dd>

  <dt>x, object</dt>
<dd><p>model matrix to be lagged; lagImpact objects created by <code>impacts</code> methods</p></dd>

  <dt>adjust_k</dt>
<dd><p>default TRUE if SDEM else FALSE, adjust internal OLS SDEM standard errors by dividing by n rather than (n-k) (default changed and bug fixed after 0.7-8; standard errors now ML in SDEM summary and impacts summary and identical - for SLX use FALSE)</p></dd>

  <dt>newdata</dt>
<dd><p>data frame in which to predict --- if NULL, predictions are
for the data on which the model was fitted. Should have row names corresponding to region.id. If row names are exactly the same than the ones used for training, it uses in-sample predictors for forecast.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>The <code>lmSLX</code> function returns an “lm” object with a “mixedImps” list of three impact matrixes (impacts and standard errors) for direct, indirect and total impacts; total impacts calculated using <code><a href="https://rdrr.io/pkg/gmodels/man/estimable.html" class="external-link">gmodels::estimable()</a></code>.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></code>, <code><a href="https://rdrr.io/pkg/gmodels/man/estimable.html" class="external-link">estimable</a></code></p></div>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Roger Bivand <a href="mailto:Roger.Bivand@nhh.no">Roger.Bivand@nhh.no</a></p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">oldcol</span>, package<span class="op">=</span><span class="st">"spdep"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">lw</span> <span class="op">&lt;-</span> <span class="fu">spdep</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/spdep/reference/nb2listw.html" class="external-link">nb2listw</a></span><span class="op">(</span><span class="va">COL.nb</span>, style<span class="op">=</span><span class="st">"W"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">COL.SLX</span> <span class="op">&lt;-</span> <span class="fu">lmSLX</span><span class="op">(</span><span class="va">CRIME</span> <span class="op">~</span> <span class="va">INC</span> <span class="op">+</span> <span class="va">HOVAL</span>, data<span class="op">=</span><span class="va">COL.OLD</span>, listw<span class="op">=</span><span class="va">lw</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">COL.SLX</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lm(formula = formula(paste("y ~ ", paste(colnames(x)[-1], collapse = "+"))), </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     data = as.data.frame(x), weights = weights)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residuals:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Min      1Q  Median      3Q     Max </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -36.536  -7.835   0.474   8.349  25.594 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             Estimate Std. Error t value Pr(&gt;|t|)    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)  75.0287     6.6260  11.323 1.26e-14 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> INC          -1.1089     0.3738  -2.967  0.00485 ** </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HOVAL        -0.2897     0.1014  -2.858  0.00649 ** </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lag.INC      -1.3710     0.5613  -2.443  0.01867 *  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lag.HOVAL     0.1918     0.2003   0.957  0.34369    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residual standard error: 10.93 on 44 degrees of freedom</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Multiple R-squared:  0.6088,	Adjusted R-squared:  0.5732 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> F-statistic: 17.12 on 4 and 44 DF,  p-value: 1.553e-08</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu"><a href="impacts.html">impacts</a></span><span class="op">(</span><span class="va">COL.SLX</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Impact measures (SlX, estimable, n-k):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           Direct   Indirect       Total</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> INC   -1.1089293 -1.3709725 -2.47990173</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HOVAL -0.2897283  0.1917608 -0.09796753</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ========================================================</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Standard errors:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          Direct  Indirect     Total</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> INC   0.3738129 0.5612771 0.4965456</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HOVAL 0.1013673 0.2003335 0.2028016</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ========================================================</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Z-values:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          Direct   Indirect      Total</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> INC   -2.966535 -2.4425945 -4.9943086</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HOVAL -2.858202  0.9572079 -0.4830709</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> p-values:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       Direct    Indirect Total     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> INC   0.0030118 0.014582 5.9047e-07</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HOVAL 0.0042605 0.338462 0.62905   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="va">COL.SLX</span> <span class="op">&lt;-</span> <span class="fu">lmSLX</span><span class="op">(</span><span class="va">CRIME</span> <span class="op">~</span> <span class="va">INC</span> <span class="op">+</span> <span class="va">HOVAL</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">HOVAL</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>, data<span class="op">=</span><span class="va">COL.OLD</span>, listw<span class="op">=</span><span class="va">lw</span>, Durbin<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu"><a href="impacts.html">impacts</a></span><span class="op">(</span><span class="va">COL.SLX</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Impact measures (SlX, estimable, n-k):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                  Direct     Indirect       Total</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> INC        -0.947594274 -1.275338647 -2.22293292</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HOVAL      -0.777427839 -0.355048446 -1.13247628</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> I(HOVAL^2)  0.004639919  0.005608104  0.01024802</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ========================================================</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Standard errors:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 Direct   Indirect      Total</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> INC        0.398832844 0.59687399 0.56325440</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HOVAL      0.464456540 0.98213200 1.07348981</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> I(HOVAL^2) 0.004226259 0.00908385 0.01025212</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ========================================================</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Z-values:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               Direct   Indirect      Total</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> INC        -2.375918 -2.1366966 -3.9465877</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HOVAL      -1.673844 -0.3615079 -1.0549483</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> I(HOVAL^2)  1.097879  0.6173709  0.9996008</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> p-values:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            Direct   Indirect Total     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> INC        0.017505 0.032623 7.9273e-05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HOVAL      0.094161 0.717720 0.29145   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> I(HOVAL^2) 0.272258 0.536990 0.31750   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">COL.SLX</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lm(formula = formula(paste("y ~ ", paste(colnames(x)[-1], collapse = "+"))), </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     data = as.data.frame(x), weights = weights)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residuals:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Min      1Q  Median      3Q     Max </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -33.974  -7.764   0.907   6.820  24.395 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 Estimate Std. Error t value Pr(&gt;|t|)    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)    92.459835  19.278187   4.796 2.06e-05 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> INC            -0.947594   0.398833  -2.376   0.0221 *  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HOVAL          -0.777428   0.464457  -1.674   0.1016    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> I.HOVAL.2.      0.004640   0.004226   1.098   0.2785    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lag.INC        -1.275339   0.596874  -2.137   0.0385 *  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lag.HOVAL      -0.355048   0.982132  -0.362   0.7195    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lag.I.HOVAL.2.  0.005608   0.009084   0.617   0.5403    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residual standard error: 10.99 on 42 degrees of freedom</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Multiple R-squared:  0.6224,	Adjusted R-squared:  0.5684 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> F-statistic: 11.54 on 6 and 42 DF,  p-value: 1.361e-07</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="va">COL.SLX</span> <span class="op">&lt;-</span> <span class="fu">lmSLX</span><span class="op">(</span><span class="va">CRIME</span> <span class="op">~</span> <span class="va">INC</span> <span class="op">+</span> <span class="va">HOVAL</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">HOVAL</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>, data<span class="op">=</span><span class="va">COL.OLD</span>, listw<span class="op">=</span><span class="va">lw</span>, Durbin<span class="op">=</span><span class="op">~</span><span class="va">INC</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu"><a href="impacts.html">impacts</a></span><span class="op">(</span><span class="va">COL.SLX</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Impact measures (SlX, estimable, n-k):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                  Direct  Indirect        Total</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> INC        -1.079064628 -1.010896 -2.089960575</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HOVAL      -0.634518755        NA -0.634518755</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> I(HOVAL^2)  0.003455273        NA  0.003455273</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ========================================================</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Standard errors:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                Direct  Indirect      Total</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> INC        0.38471071 0.4552667 0.44650193</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HOVAL      0.44760078        NA 0.44760078</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> I(HOVAL^2) 0.00411036        NA 0.00411036</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ========================================================</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Z-values:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                Direct  Indirect      Total</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> INC        -2.8048728 -2.220448 -4.6807425</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HOVAL      -1.4175997        NA -1.4175997</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> I(HOVAL^2)  0.8406254        NA  0.8406254</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> p-values:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            Direct    Indirect Total     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> INC        0.0050336 0.026388 2.8584e-06</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HOVAL      0.1563077 NA       0.15631   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> I(HOVAL^2) 0.4005579 NA       0.40056   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">COL.SLX</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lm(formula = formula(paste("y ~ ", paste(colnames(x)[-1], collapse = "+"))), </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     data = as.data.frame(x), weights = weights)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residuals:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Min      1Q  Median      3Q     Max </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -35.908  -7.085   0.770   7.147  24.684 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              Estimate Std. Error t value Pr(&gt;|t|)    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept) 83.679968   9.264846   9.032  1.4e-11 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> INC         -1.079065   0.384711  -2.805  0.00747 ** </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HOVAL       -0.634519   0.447601  -1.418  0.16335    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> I.HOVAL.2.   0.003455   0.004110   0.841  0.40510    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lag.INC     -1.010896   0.455267  -2.220  0.03159 *  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residual standard error: 10.96 on 44 degrees of freedom</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Multiple R-squared:  0.607,	Adjusted R-squared:  0.5712 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> F-statistic: 16.99 on 4 and 44 DF,  p-value: 1.716e-08</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="va">COL.SLX</span> <span class="op">&lt;-</span> <span class="fu">lmSLX</span><span class="op">(</span><span class="va">CRIME</span> <span class="op">~</span> <span class="va">INC</span>, data<span class="op">=</span><span class="va">COL.OLD</span>, listw<span class="op">=</span><span class="va">lw</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">COL.SLX</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lm(formula = formula(paste("y ~ ", paste(colnames(x)[-1], collapse = "+"))), </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     data = as.data.frame(x), weights = weights)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residuals:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Min      1Q  Median      3Q     Max </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -49.297  -6.658   0.669   7.315  29.826 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             Estimate Std. Error t value Pr(&gt;|t|)    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)  73.9849     6.2081  11.918 1.16e-15 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> INC          -1.5889     0.3564  -4.458 5.28e-05 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lag.INC      -1.0859     0.4812  -2.257   0.0288 *  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residual standard error: 11.65 on 46 degrees of freedom</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Multiple R-squared:  0.5353,	Adjusted R-squared:  0.5151 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> F-statistic: 26.49 on 2 and 46 DF,  p-value: 2.214e-08</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu"><a href="impacts.html">impacts</a></span><span class="op">(</span><span class="va">COL.SLX</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Impact measures (SlX, estimable, n-k):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        Direct  Indirect     Total</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> INC -1.588901 -1.085867 -2.674768</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ========================================================</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Standard errors:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        Direct  Indirect    Total</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> INC 0.3564039 0.4811809 0.407313</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ========================================================</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Z-values:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        Direct  Indirect     Total</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> INC -4.458147 -2.256671 -6.566861</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> p-values:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Direct     Indirect Total     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> INC 8.2671e-06 0.024029 5.1387e-11</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="va">crds</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">COL.OLD</span><span class="op">$</span><span class="va">X</span>, <span class="va">COL.OLD</span><span class="op">$</span><span class="va">Y</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mdist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diff.html" class="external-link">diff</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">crds</span>, <span class="fl">2</span>, <span class="va">range</span><span class="op">)</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dnb</span> <span class="op">&lt;-</span> <span class="fu">spdep</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/spdep/reference/dnearneigh.html" class="external-link">dnearneigh</a></span><span class="op">(</span><span class="va">crds</span>, <span class="fl">0</span>, <span class="va">mdist</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dists</span> <span class="op">&lt;-</span> <span class="fu">spdep</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/spdep/reference/nbdists.html" class="external-link">nbdists</a></span><span class="op">(</span><span class="va">dnb</span>, <span class="va">crds</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">f</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">form</span>, <span class="va">data</span>, <span class="va">dnb</span>, <span class="va">dists</span>, <span class="va">verbose</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="va">glst</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">dists</span>, <span class="kw">function</span><span class="op">(</span><span class="va">d</span><span class="op">)</span> <span class="fl">1</span><span class="op">/</span><span class="op">(</span><span class="va">d</span><span class="op">^</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">lw</span> <span class="op">&lt;-</span> <span class="fu">spdep</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/spdep/reference/nb2listw.html" class="external-link">nb2listw</a></span><span class="op">(</span><span class="va">dnb</span>, glist<span class="op">=</span><span class="va">glst</span>, style<span class="op">=</span><span class="st">"B"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/logLik.html" class="external-link">logLik</a></span><span class="op">(</span><span class="fu">lmSLX</span><span class="op">(</span>form<span class="op">=</span><span class="va">form</span>, data<span class="op">=</span><span class="va">data</span>, listw<span class="op">=</span><span class="va">lw</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="kw">if</span> <span class="op">(</span><span class="va">verbose</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"power:"</span>, <span class="va">x</span>, <span class="st">"logLik:"</span>, <span class="va">res</span>, <span class="st">"\n"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">res</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span><span class="va">opt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/optimize.html" class="external-link">optimize</a></span><span class="op">(</span><span class="va">f</span>, interval<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">4</span><span class="op">)</span>, form<span class="op">=</span><span class="va">CRIME</span> <span class="op">~</span> <span class="va">INC</span> <span class="op">+</span> <span class="va">HOVAL</span>,</span></span>
<span class="r-in"><span> data<span class="op">=</span><span class="va">COL.OLD</span>, dnb<span class="op">=</span><span class="va">dnb</span>, dists<span class="op">=</span><span class="va">dists</span>, verbose<span class="op">=</span><span class="cn">TRUE</span>, maximum<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> power: 1.589667 logLik: -172.6864 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> power: 2.510333 logLik: -177.741 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> power: 1.020665 logLik: -171.5379 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> power: 0.8721475 logLik: -171.7979 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> power: 1.11302 logLik: -171.4973 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> power: 1.107329 logLik: -171.497 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> power: 1.105705 logLik: -171.497 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> power: 1.105746 logLik: -171.497 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> power: 1.105664 logLik: -171.497 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> power: 1.105705 logLik: -171.497 </span>
<span class="r-in"><span><span class="va">glst</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">dists</span>, <span class="kw">function</span><span class="op">(</span><span class="va">d</span><span class="op">)</span> <span class="fl">1</span><span class="op">/</span><span class="op">(</span><span class="va">d</span><span class="op">^</span><span class="va">opt</span><span class="op">$</span><span class="va">maximum</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">lw</span> <span class="op">&lt;-</span> <span class="fu">spdep</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/spdep/reference/nb2listw.html" class="external-link">nb2listw</a></span><span class="op">(</span><span class="va">dnb</span>, glist<span class="op">=</span><span class="va">glst</span>, style<span class="op">=</span><span class="st">"B"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">SLX</span> <span class="op">&lt;-</span> <span class="fu">lmSLX</span><span class="op">(</span><span class="va">CRIME</span> <span class="op">~</span> <span class="va">INC</span> <span class="op">+</span> <span class="va">HOVAL</span>, data<span class="op">=</span><span class="va">COL.OLD</span>, listw<span class="op">=</span><span class="va">lw</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">SLX</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lm(formula = formula(paste("y ~ ", paste(colnames(x)[-1], collapse = "+"))), </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     data = as.data.frame(x), weights = weights)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residuals:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Min       1Q   Median       3Q      Max </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -25.1535  -4.7529  -0.9819   4.8053  22.2274 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 Estimate Std. Error t value Pr(&gt;|t|)  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)     18.78498   11.23795   1.672   0.1019  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> INC             -0.65428    0.29463  -2.221   0.0317 *</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HOVAL           -0.18244    0.08138  -2.242   0.0302 *</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lag..Intercept.  6.27790    4.44284   1.413   0.1648  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lag.INC         -0.12958    0.28794  -0.450   0.6550  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lag.HOVAL        0.02668    0.11273   0.237   0.8141  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residual standard error: 8.553 on 43 degrees of freedom</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Multiple R-squared:  0.7659,	Adjusted R-squared:  0.7387 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> F-statistic: 28.14 on 5 and 43 DF,  p-value: 1.544e-12</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu"><a href="impacts.html">impacts</a></span><span class="op">(</span><span class="va">SLX</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Impact measures (SlX, estimable, n-k):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           Direct    Indirect      Total</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> INC   -0.6542760 -0.12957739 -0.7838534</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HOVAL -0.1824383  0.02667561 -0.1557627</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ========================================================</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Standard errors:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           Direct  Indirect     Total</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> INC   0.29463342 0.2879383 0.3742251</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HOVAL 0.08138257 0.1127279 0.1404591</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ========================================================</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Z-values:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          Direct   Indirect     Total</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> INC   -2.220644 -0.4500179 -2.094604</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HOVAL -2.241736  0.2366371 -1.108954</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> p-values:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       Direct   Indirect Total   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> INC   0.026375 0.65270  0.036206</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HOVAL 0.024978 0.81294  0.267450</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="co"># }</span></span></span>
<span class="r-in"><span><span class="va">COL.SLX</span> <span class="op">&lt;-</span> <span class="fu">lmSLX</span><span class="op">(</span><span class="va">CRIME</span> <span class="op">~</span> <span class="va">INC</span> <span class="op">+</span> <span class="va">HOVAL</span>, data<span class="op">=</span><span class="va">COL.OLD</span>, listw<span class="op">=</span><span class="va">lw</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">pslx0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">COL.SLX</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">pslx1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">COL.SLX</span>, newdata<span class="op">=</span><span class="va">COL.OLD</span>, listw<span class="op">=</span><span class="va">lw</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="va">pslx0</span>, <span class="va">pslx1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-in"><span><span class="va">COL.OLD1</span> <span class="op">&lt;-</span> <span class="va">COL.OLD</span></span></span>
<span class="r-in"><span><span class="va">COL.OLD1</span><span class="op">$</span><span class="va">INC</span> <span class="op">&lt;-</span> <span class="va">COL.OLD1</span><span class="op">$</span><span class="va">INC</span> <span class="op">+</span> <span class="fl">1</span></span></span>
<span class="r-in"><span><span class="va">pslx2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">COL.SLX</span>, newdata<span class="op">=</span><span class="va">COL.OLD1</span>, listw<span class="op">=</span><span class="va">lw</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">COL.SLX</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">4</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 5.623621</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">pslx2</span><span class="op">-</span><span class="va">pslx1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] -1.425045</span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Roger Bivand, Gianfranco Piras.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer></div>

  


  

  </body></html>

