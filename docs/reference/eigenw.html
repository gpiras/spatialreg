<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Spatial weights matrix eigenvalues — griffith_sone • spatialreg</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Spatial weights matrix eigenvalues — griffith_sone" />
<meta property="og:description" content="The eigenw function returns a numeric vector of eigenvalues of 
the weights matrix generated from the spatial weights object listw. 
The eigenvalues are used to speed the computation of the Jacobian in 
spatial model estimation:
$$\log(\det[I - \rho W]) = \sum_{i=1}^{n}\log(1 - \rho \lambda_i)$$
where \(W\) is the n by n spatial weights matrix, and \(\lambda_i\) are the
eigenvalues of \(W\)." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">spatialreg</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.1-7</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/SpatialFiltering.html">Moran Eigenvectors</a>
    </li>
    <li>
      <a href="../articles/sids_models.html">North Carolina SIDS data set (models)</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/r-spatial/spatialreg/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Spatial weights matrix eigenvalues</h1>
    
    <div class="hidden name"><code>eigenw.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>The <code>eigenw</code> function returns a numeric vector of eigenvalues of 
the weights matrix generated from the spatial weights object <code>listw</code>. 
The eigenvalues are used to speed the computation of the Jacobian in 
spatial model estimation:</p>
<p>$$\log(\det[I - \rho W]) = \sum_{i=1}^{n}\log(1 - \rho \lambda_i)$$</p>
<p>where \(W\) is the n by n spatial weights matrix, and \(\lambda_i\) are the
eigenvalues of \(W\).</p>
    </div>

    <pre class="usage"><span class='fu'>eigenw</span><span class='op'>(</span><span class='va'>listw</span>, quiet<span class='op'>=</span><span class='cn'>NULL</span><span class='op'>)</span>
<span class='fu'>griffith_sone</span><span class='op'>(</span><span class='va'>P</span>, <span class='va'>Q</span>, type<span class='op'>=</span><span class='st'>"rook"</span><span class='op'>)</span>
<span class='fu'>subgraph_eigenw</span><span class='op'>(</span><span class='va'>nb</span>, glist<span class='op'>=</span><span class='cn'>NULL</span>, style<span class='op'>=</span><span class='st'>"W"</span>, zero.policy<span class='op'>=</span><span class='cn'>NULL</span>, quiet<span class='op'>=</span><span class='cn'>NULL</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>listw</th>
      <td><p>a <code>listw</code> object created for example by <code>nb2listw</code></p></td>
    </tr>
    <tr>
      <th>quiet</th>
      <td><p>default NULL, use global !verbose option value; set to FALSE for short summary</p></td>
    </tr>
    <tr>
      <th>P</th>
      <td><p>number of columns in the grid (number of units in a horizontal axis direction)</p></td>
    </tr>
    <tr>
      <th>Q</th>
      <td><p>number of rows in the grid (number of units in a vertical axis direction.)</p></td>
    </tr>
    <tr>
      <th>type</th>
      <td><p>&#8220;rook&#8221; or &#8220;queen&#8221;</p></td>
    </tr>
    <tr>
      <th>nb</th>
      <td><p>an object of class <code>nb</code></p></td>
    </tr>
    <tr>
      <th>glist</th>
      <td><p>list of general weights corresponding to neighbours</p></td>
    </tr>
    <tr>
      <th>style</th>
      <td><p><code>style</code> can take values &#8220;W&#8221;, &#8220;B&#8221;, &#8220;C&#8221;, &#8220;U&#8221;, &#8220;minmax&#8221; and &#8220;S&#8221;</p></td>
    </tr>
    <tr>
      <th>zero.policy</th>
      <td><p>default NULL, use global option value; if FALSE stop with error for any empty neighbour sets, if TRUE permit the weights list to be formed with zero-length weights vectors</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p><!-- %The \code{eigenw} function computes the eigenvalues of a single spatial weights object.  -->
The <code>griffith_sone</code> function function may be used, following Ord and Gasim (for references see Griffith and Sone (1995)), to calculate analytical eigenvalues for binary rook or queen contiguous neighbours where the data are arranged as a regular P times Q grid. The <code>subgraph_eigenw</code> function may be used when there are multiple graph components, of which the largest may be handled as a dense matrix. Here the eigenvalues are computed for each subgraph in turn, and catenated to reconstruct the complete set. The functions may be used to provide pre-computed eigenvalues for spatial regression functions.</p>
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>a numeric or complex vector of eigenvalues of the weights matrix generated from the spatial weights object.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Cliff, A. D., Ord, J. K. 1981 Spatial processes, Pion, p. 155;
Ord, J. K. 1975 Estimation methods for models of spatial interaction, Journal
of the American Statistical Association, 70, 120-126.; Griffith, D. A. and Sone, A. (1995). Trade-offs associated with normalizing constant computational simplifications for estimating spatial statistical models. Journal of Statistical Computation and Simulation, 51, 165-183.</p>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Roger Bivand <a href='mailto:Roger.Bivand@nhh.no'>Roger.Bivand@nhh.no</a></p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='https://rdrr.io/r/base/eigen.html'>eigen</a></code><!-- %, \code{\link{logSpwdet}} --></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'>#require(spdep)</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>oldcol</span>, package<span class='op'>=</span><span class='st'>"spdep"</span><span class='op'>)</span>
<span class='va'>W.eig</span> <span class='op'>&lt;-</span> <span class='fu'>eigenw</span><span class='op'>(</span><span class='fu'>spdep</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/spdep/man/nb2listw.html'>nb2listw</a></span><span class='op'>(</span><span class='va'>COL.nb</span>, style<span class='op'>=</span><span class='st'>"W"</span><span class='op'>)</span><span class='op'>)</span>
<span class='fl'>1</span><span class='op'>/</span><span class='fu'><a href='https://rdrr.io/r/base/range.html'>range</a></span><span class='op'>(</span><span class='va'>W.eig</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] -1.536177  1.000000</div><div class='input'><span class='va'>S.eig</span> <span class='op'>&lt;-</span> <span class='fu'>eigenw</span><span class='op'>(</span><span class='fu'>spdep</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/spdep/man/nb2listw.html'>nb2listw</a></span><span class='op'>(</span><span class='va'>COL.nb</span>, style<span class='op'>=</span><span class='st'>"S"</span><span class='op'>)</span><span class='op'>)</span>
<span class='fl'>1</span><span class='op'>/</span><span class='fu'><a href='https://rdrr.io/r/base/range.html'>range</a></span><span class='op'>(</span><span class='va'>S.eig</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] -1.7364189  0.8918997</div><div class='input'><span class='va'>B.eig</span> <span class='op'>&lt;-</span> <span class='fu'>eigenw</span><span class='op'>(</span><span class='fu'>spdep</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/spdep/man/nb2listw.html'>nb2listw</a></span><span class='op'>(</span><span class='va'>COL.nb</span>, style<span class='op'>=</span><span class='st'>"B"</span><span class='op'>)</span><span class='op'>)</span>
<span class='fl'>1</span><span class='op'>/</span><span class='fu'><a href='https://rdrr.io/r/base/range.html'>range</a></span><span class='op'>(</span><span class='va'>B.eig</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] -0.3229290  0.1692726</div><div class='input'><span class='co'># cases for intrinsically asymmetric weights</span>
<span class='va'>crds</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span><span class='op'>(</span><span class='va'>COL.OLD</span><span class='op'>$</span><span class='va'>X</span>, <span class='va'>COL.OLD</span><span class='op'>$</span><span class='va'>Y</span><span class='op'>)</span>
<span class='va'>k3</span> <span class='op'>&lt;-</span> <span class='fu'>spdep</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/spdep/man/knn2nb.html'>knn2nb</a></span><span class='op'>(</span><span class='fu'>spdep</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/spdep/man/knearneigh.html'>knearneigh</a></span><span class='op'>(</span><span class='va'>crds</span>, k<span class='op'>=</span><span class='fl'>3</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'>spdep</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/spdep/man/testnb.html'>is.symmetric.nb</a></span><span class='op'>(</span><span class='va'>k3</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] FALSE</div><div class='input'><span class='va'>k3eig</span> <span class='op'>&lt;-</span> <span class='fu'>eigenw</span><span class='op'>(</span><span class='fu'>spdep</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/spdep/man/nb2listw.html'>nb2listw</a></span><span class='op'>(</span><span class='va'>k3</span>, style<span class='op'>=</span><span class='st'>"W"</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/complex.html'>is.complex</a></span><span class='op'>(</span><span class='va'>k3eig</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] TRUE</div><div class='input'><span class='va'>rho</span> <span class='op'>&lt;-</span> <span class='fl'>0.5</span>
<span class='va'>Jc</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='fl'>1</span> <span class='op'>-</span> <span class='va'>rho</span> <span class='op'>*</span> <span class='va'>k3eig</span><span class='op'>)</span><span class='op'>)</span>
<span class='co'># complex eigenvalue Jacobian</span>
<span class='va'>Jc</span>
</div><div class='output co'>#&gt; [1] -1.749705+0i</div><div class='input'><span class='co'># subgraphs</span>
<span class='va'>nc</span> <span class='op'>&lt;-</span> <span class='fu'>spdep</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/spdep/man/compon.html'>n.comp.nb</a></span><span class='op'>(</span><span class='va'>k3</span><span class='op'>)</span>
<span class='va'>nc</span><span class='op'>$</span><span class='va'>nc</span>
</div><div class='output co'>#&gt; [1] 2</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/table.html'>table</a></span><span class='op'>(</span><span class='va'>nc</span><span class='op'>$</span><span class='va'>comp.id</span><span class='op'>)</span>
</div><div class='output co'>#&gt; 
#&gt;  1  2 
#&gt; 43  6 </div><div class='input'><span class='va'>k3eigSG</span> <span class='op'>&lt;-</span> <span class='fu'>subgraph_eigenw</span><span class='op'>(</span><span class='va'>k3</span>, style<span class='op'>=</span><span class='st'>"W"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/all.equal.html'>all.equal</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/sort.html'>sort</a></span><span class='op'>(</span><span class='va'>k3eig</span><span class='op'>)</span>, <span class='va'>k3eigSG</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] TRUE</div><div class='input'><span class='va'>W</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://r-spatial.github.io/sf/reference/coerce-methods.html'>as</a></span><span class='op'>(</span><span class='fu'>spdep</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/spdep/man/nb2listw.html'>nb2listw</a></span><span class='op'>(</span><span class='va'>k3</span>, style<span class='op'>=</span><span class='st'>"W"</span><span class='op'>)</span>, <span class='st'>"CsparseMatrix"</span><span class='op'>)</span>
<span class='va'>I</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/diag.html'>diag</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>k3</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>Jl</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>abs</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/diag.html'>diag</a></span><span class='op'>(</span><span class='fu'>slot</span><span class='op'>(</span><span class='fu'>lu</span><span class='op'>(</span><span class='va'>I</span> <span class='op'>-</span> <span class='va'>rho</span> <span class='op'>*</span> <span class='va'>W</span><span class='op'>)</span>, <span class='st'>"U"</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
<span class='co'># LU Jacobian equals complex eigenvalue Jacobian</span>
<span class='va'>Jl</span>
</div><div class='output co'>#&gt; [1] -1.749705</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/all.equal.html'>all.equal</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/complex.html'>Re</a></span><span class='op'>(</span><span class='va'>Jc</span><span class='op'>)</span>, <span class='va'>Jl</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] TRUE</div><div class='input'><span class='co'># wrong value if only real part used</span>
<span class='va'>Jr</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='fl'>1</span> <span class='op'>-</span> <span class='va'>rho</span> <span class='op'>*</span> <span class='fu'><a href='https://rdrr.io/r/base/complex.html'>Re</a></span><span class='op'>(</span><span class='va'>k3eig</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>Jr</span>
</div><div class='output co'>#&gt; [1] -1.762734</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/all.equal.html'>all.equal</a></span><span class='op'>(</span><span class='va'>Jr</span>, <span class='va'>Jl</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] "Mean relative difference: 0.007391147"</div><div class='input'><span class='co'># construction of Jacobian from complex conjugate pairs (Jan Hauke)</span>
<span class='va'>Rev</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/complex.html'>Re</a></span><span class='op'>(</span><span class='va'>k3eig</span><span class='op'>)</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/which.html'>which</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/complex.html'>Im</a></span><span class='op'>(</span><span class='va'>k3eig</span><span class='op'>)</span> <span class='op'>==</span> <span class='fl'>0</span><span class='op'>)</span><span class='op'>]</span>
<span class='co'># real eigenvalues</span>
<span class='va'>Cev</span> <span class='op'>&lt;-</span> <span class='va'>k3eig</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/which.html'>which</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/complex.html'>Im</a></span><span class='op'>(</span><span class='va'>k3eig</span><span class='op'>)</span> <span class='op'>!=</span> <span class='fl'>0</span><span class='op'>)</span><span class='op'>]</span>
<span class='va'>pCev</span> <span class='op'>&lt;-</span> <span class='va'>Cev</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/complex.html'>Im</a></span><span class='op'>(</span><span class='va'>Cev</span><span class='op'>)</span> <span class='op'>&gt;</span> <span class='fl'>0</span><span class='op'>]</span>
<span class='co'># separate complex conjugate pairs</span>
<span class='va'>RpCev</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/complex.html'>Re</a></span><span class='op'>(</span><span class='va'>pCev</span><span class='op'>)</span>
<span class='va'>IpCev</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/complex.html'>Im</a></span><span class='op'>(</span><span class='va'>pCev</span><span class='op'>)</span>
<span class='co'># reassemble Jacobian</span>
<span class='va'>Jc1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='fl'>1</span> <span class='op'>-</span> <span class='va'>rho</span><span class='op'>*</span><span class='va'>Rev</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='op'>(</span><span class='fl'>1</span> <span class='op'>-</span> <span class='va'>rho</span> <span class='op'>*</span> <span class='va'>RpCev</span><span class='op'>)</span><span class='op'>^</span><span class='fl'>2</span> <span class='op'>+</span> <span class='op'>(</span><span class='va'>rho</span><span class='op'>^</span><span class='fl'>2</span><span class='op'>)</span><span class='op'>*</span><span class='op'>(</span><span class='va'>IpCev</span><span class='op'>^</span><span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/all.equal.html'>all.equal</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/complex.html'>Re</a></span><span class='op'>(</span><span class='va'>Jc</span><span class='op'>)</span>, <span class='va'>Jc1</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] TRUE</div><div class='input'><span class='co'># impact of omitted complex part term in real part only Jacobian</span>
<span class='va'>Jc2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='fl'>1</span> <span class='op'>-</span> <span class='va'>rho</span><span class='op'>*</span><span class='va'>Rev</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='op'>(</span><span class='fl'>1</span> <span class='op'>-</span> <span class='va'>rho</span> <span class='op'>*</span> <span class='va'>RpCev</span><span class='op'>)</span><span class='op'>^</span><span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/all.equal.html'>all.equal</a></span><span class='op'>(</span><span class='va'>Jr</span>, <span class='va'>Jc2</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] TRUE</div><div class='input'><span class='co'># trace of asymmetric (WW) and crossprod of complex eigenvalues for APLE</span>
<span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/diag.html'>diag</a></span><span class='op'>(</span><span class='va'>W</span> <span class='op'>%*%</span> <span class='va'>W</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] 11.55556</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/crossprod.html'>crossprod</a></span><span class='op'>(</span><span class='va'>k3eig</span><span class='op'>)</span>
</div><div class='output co'>#&gt;             [,1]
#&gt; [1,] 11.55556+0i</div><div class='input'><span class='co'># analytical regular grid eigenvalues</span>
<span class='va'>rg</span> <span class='op'>&lt;-</span> <span class='fu'>spdep</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/spdep/man/cell2nb.html'>cell2nb</a></span><span class='op'>(</span>ncol<span class='op'>=</span><span class='fl'>7</span>, nrow<span class='op'>=</span><span class='fl'>7</span>, type<span class='op'>=</span><span class='st'>"rook"</span><span class='op'>)</span>
<span class='va'>rg_eig</span> <span class='op'>&lt;-</span> <span class='fu'>eigenw</span><span class='op'>(</span><span class='fu'>spdep</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/spdep/man/nb2listw.html'>nb2listw</a></span><span class='op'>(</span><span class='va'>rg</span>, style<span class='op'>=</span><span class='st'>"B"</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>rg_GS</span> <span class='op'>&lt;-</span> <span class='fu'>griffith_sone</span><span class='op'>(</span>P<span class='op'>=</span><span class='fl'>7</span>, Q<span class='op'>=</span><span class='fl'>7</span>, type<span class='op'>=</span><span class='st'>"rook"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/all.equal.html'>all.equal</a></span><span class='op'>(</span><span class='va'>rg_eig</span>, <span class='va'>rg_GS</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] TRUE</div><div class='input'><span class='co'># \dontrun{</span>
<span class='va'>run</span> <span class='op'>&lt;-</span> <span class='cn'>FALSE</span>
<span class='kw'>if</span> <span class='op'>(</span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>require</a></span><span class='op'>(</span><span class='st'><a href='https://github.com/yixuan/RSpectra'>"RSpectra"</a></span>, quietly<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span><span class='op'>)</span> <span class='va'>run</span> <span class='op'>&lt;-</span> <span class='cn'>TRUE</span>
<span class='kw'>if</span> <span class='op'>(</span><span class='va'>run</span><span class='op'>)</span> <span class='op'>{</span>
<span class='va'>B</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://r-spatial.github.io/sf/reference/coerce-methods.html'>as</a></span><span class='op'>(</span><span class='fu'>spdep</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/spdep/man/nb2listw.html'>nb2listw</a></span><span class='op'>(</span><span class='va'>rg</span>, style<span class='op'>=</span><span class='st'>"B"</span><span class='op'>)</span>, <span class='st'>"CsparseMatrix"</span><span class='op'>)</span>
<span class='va'>res1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/RSpectra/man/eigs.html'>eigs</a></span><span class='op'>(</span><span class='va'>B</span>, k<span class='op'>=</span><span class='fl'>1</span>, which<span class='op'>=</span><span class='st'>"LR"</span><span class='op'>)</span><span class='op'>$</span><span class='va'>values</span>
<span class='va'>resn</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/RSpectra/man/eigs.html'>eigs</a></span><span class='op'>(</span><span class='va'>B</span>, k<span class='op'>=</span><span class='fl'>1</span>, which<span class='op'>=</span><span class='st'>"SR"</span><span class='op'>)</span><span class='op'>$</span><span class='va'>values</span>
<span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/complex.html'>Re</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>resn</span>, <span class='va'>res1</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
<span class='op'>}</span>
</div><div class='output co'>#&gt; [1] -3.695518  3.695518</div><div class='input'><span class='kw'>if</span> <span class='op'>(</span><span class='va'>run</span><span class='op'>)</span> <span class='op'>{</span>
<span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/all.equal.html'>all.equal</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/range.html'>range</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/complex.html'>Re</a></span><span class='op'>(</span><span class='va'>rg_eig</span><span class='op'>)</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>resn</span>, <span class='va'>res1</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> 
<span class='op'>}</span>
</div><div class='output co'>#&gt; [1] TRUE</div><div class='input'><span class='kw'>if</span> <span class='op'>(</span><span class='va'>run</span><span class='op'>)</span> <span class='op'>{</span>
<span class='va'>lw</span> <span class='op'>&lt;-</span> <span class='fu'>spdep</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/spdep/man/nb2listw.html'>nb2listw</a></span><span class='op'>(</span><span class='va'>rg</span>, style<span class='op'>=</span><span class='st'>"W"</span><span class='op'>)</span>
<span class='va'>rg_eig</span> <span class='op'>&lt;-</span> <span class='fu'>eigenw</span><span class='op'>(</span><span class='fu'><a href='similar.listw.html'>similar.listw</a></span><span class='op'>(</span><span class='va'>lw</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/range.html'>range</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/complex.html'>Re</a></span><span class='op'>(</span><span class='va'>rg_eig</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
<span class='op'>}</span>
</div><div class='output co'>#&gt; [1] -1  1</div><div class='input'><span class='kw'>if</span> <span class='op'>(</span><span class='va'>run</span><span class='op'>)</span> <span class='op'>{</span>
<span class='va'>W</span>  <span class='op'>&lt;-</span> <span class='fu'><a href='https://r-spatial.github.io/sf/reference/coerce-methods.html'>as</a></span><span class='op'>(</span><span class='va'>lw</span>, <span class='st'>"CsparseMatrix"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/complex.html'>Re</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/pkg/RSpectra/man/eigs.html'>eigs</a></span><span class='op'>(</span><span class='va'>W</span>, k<span class='op'>=</span><span class='fl'>1</span>, which<span class='op'>=</span><span class='st'>"SR"</span><span class='op'>)</span><span class='op'>$</span><span class='va'>values</span>, <span class='fu'><a href='https://rdrr.io/pkg/RSpectra/man/eigs.html'>eigs</a></span><span class='op'>(</span><span class='va'>W</span>, k<span class='op'>=</span><span class='fl'>1</span>, which<span class='op'>=</span><span class='st'>"LR"</span><span class='op'>)</span><span class='op'>$</span><span class='va'>values</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
<span class='op'>}</span><span class='co'># }</span>
</div><div class='output co'>#&gt; [1] -1  1</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Roger Bivand, Gianfranco Piras.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


